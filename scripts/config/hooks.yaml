# Hook Definitions
# Ref: https://docs.claude.com/en/docs/claude-code/hooks.md

version: "2.0.0"

hooks:
  # PreToolUse - Malicious Behavior Detection (RUNS FIRST)
  # Catches bypass script creation attempts before other checks
  - event: "PreToolUse"
    matcher: ["Write", "Edit", "Bash"]
    command: "malicious-behavior"
    timeout: 60

  # PreToolUse - Command Guard
  - event: "PreToolUse"
    matcher: "Bash"
    command: "command-guard"
    timeout: 10

  # PreToolUse - Research Validator
  # Validates adequate research before code changes (docs, codebase inspection)
  # Skips trivial changes (< 5 lines)
  - event: "PreToolUse"
    matcher: ["Write", "Edit", "NotebookEdit"]
    command: "research-validator"
    timeout: 120

  # PreToolUse - Core Quality Guard (STEP 1: Cross-language patterns)
  # Runs on all Edit/Write operations, checks patterns_core.txt
  - event: "PreToolUse"
    matcher: ["Edit", "Write"]
    command: "code-quality-core"
    timeout: 60

  # PreToolUse - Python Quality Guard (STEP 2: Python-specific patterns)
  # Only runs on Python files, checks patterns_python.txt
  - event: "PreToolUse"
    matcher: ["Edit", "Write"]
    command: "code-quality-python"
    timeout: 60

  # PreToolUse - Todo Completion Validator
  # Validates todos being marked complete are actually done
  - event: "PreToolUse"
    matcher: "TodoWrite"
    command: "todo-validator"
    timeout: 60

  # Stop - Response Scanner
  # Framework timeout (120s) must exceed agent timeout (20s) to ensure
  # agent timeouts are logged before framework kills the process
  - event: "Stop"
    command: "response-scanner"
    timeout: 120

  # SubagentStop - Response Scanner
  # Framework timeout (120s) must exceed agent timeout (20s) to ensure
  # agent timeouts are logged before framework kills the process
  - event: "SubagentStop"
    command: "response-scanner"
    timeout: 120
